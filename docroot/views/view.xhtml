<?xml version="1.0"?>

<f:view
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">
	<h:head />
	<h:body>

	<h:form id="formUpload" enctype="multipart/form-data">
		
		<h:panelGroup rendered="#{fileUploadBacking.user != null}">
			<p:layout id="layoutUpload" style="width:100%;height:500px" >
		 		<p:layoutUnit styleClass="westpanel" position="west" header="Select or Create Upload Folder" resizable="true" size="350" minSize="350" maxSize="600">
		 			    
		 			    <div class="nav">
		                    <p:inputText id="txtFoldername" value="#{fileUploadBacking.fileTree.newFolderName}"/>
		                    <p:commandButton  id="btnAdd" icon="ui-icon-folder-open" actionListener="#{fileUploadBacking.fileTree.addFolder}" value="New Folder" update="fileTree"/>
		                </div>              

						<p:tree id="fileTree" 
							styleClass="waveformTree"
							dynamic="true"
							selection="#{fileUploadBacking.fileTree.selectedNode}"
							selectionMode="single"
							value="#{fileUploadBacking.fileTree.treeRoot}" 
							var="node">
							
							<p:ajax event="select" listener="#{fileUploadBacking.onNodeSelect}" update="fileTree"/>
							
							<p:treeNode expandedIcon="ui-icon-folder-open" collapsedIcon="ui-icon-folder-collapsed">
								<h:outputText value="#{node}" />
							</p:treeNode>
							
							<p:treeNode type="document" icon="ui-icon ui-icon-note">
								<h:outputText value="#{node}"/>
							</p:treeNode>
							
							<p:treeNode type="analysis" icon="ui-icon ui-icon-document">
								<h:outputText value="#{node}"/>
							</p:treeNode>
							
							<p:treeNode type="document_error" icon="ui-icon ui-icon-alert">
								<h:outputText value="#{node}"/>
							</p:treeNode>
						</p:tree>
		    	</p:layoutUnit>
		    	
		    	<p:layoutUnit position="center" header="Select files form your computer to upload and save" >
			    	
			    	<p:progressBar id="progressBarClient" widgetVar="pbClient" style="width:99%" styleClass="animated" labelTemplate="{value}%"/>
			    	
			    	<p:messages id="messages_prime" showSummary="true" showDetail="true" autoUpdate="true" closable="true" escape="false" />
			    	
			    	<p:remoteCommand name="updateProgressBar" action="#{fileUploadBacking.updateProgressBar}" />
			    	<p:remoteCommand name="onComplete" action="#{fileUploadBacking.onComplete}" update="fileTree"/>
			    	
			    	<p:fileUpload id="uploader"
			                      	allowTypes="/(\.|\/)(hea|dat|xyz|xml)$/"
			                      	value="Facts" 
			      	                multiple="true"
			    	                uploadLabel="Upload All"
			          	            cancelLabel="Remove All" 
			          	            auto="false"
			              	        widgetVar="waveformFileUpload"
			                  	    fileUploadListener="#{fileUploadBacking.handleFileUpload}"
			                      	description="Select Images"
			                      	onstart="cancel();start()" />
			                      	
					   
			    </p:layoutUnit>
			    
			    <p:layoutUnit styleClass="westpanel" position="south" header="Instructions" resizable="true">
			     terse instruction text goes here. <BR/>
			    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. <BR/>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. <BR/>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. <BR/>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
			    </p:layoutUnit>
			</p:layout>
		</h:panelGroup>
		
		<h:panelGroup rendered="#{fileUploadBacking.user == null}">
			<div class="signin">
				Please <a href="/c/portal/login" rel="nofollow">Sign In</a>
			</div>
		</h:panelGroup>
	</h:form>
	
	</h:body>
</f:view>