<?xml version="1.0"?>

<f:view
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">
	<h:head />
	<h:body>


	
	<h:panelGroup layout="block" id="uploadTopContentLineShade" styleClass="topLineShade"> 
   		<h:outputText styleClass="TitleLine" value="ICM Electrocardiograph Tool Kit: Upload" />
   	</h:panelGroup>
	
	<f:event type="preRenderView" listener="#{fileUploadBacking.init}" />
	
	<h:form id="formUpload" enctype="multipart/form-data">
	<p:layout id="layoutUpload" style="width:100%;height:500px" >
  
 		<p:layoutUnit position="west" header="Select Folder to Upload Files Into" resizable="true" size="350" minSize="350" maxSize="600" >
 			    
	        	<p:panelGrid id="buttonGrid" columns="3" style="border:0;" >
                    <p:inputText id="txtFoldername" value="#{fileUploadBacking.fileTree.newFolderName}"/>
                    <p:commandButton  id="btnAdd" icon="ui-icon-folder-open" actionListener="#{fileUploadBacking.fileTree.addFolder}" value="New Folder" update="fileTree"/>
                </p:panelGrid>              

				<p:tree id="fileTree" 
					dynamic="true"
					selection="#{fileUploadBacking.fileTree.selectedNode}"
					selectionMode="single"
					value="#{fileUploadBacking.fileTree.treeRoot}" 
					var="node">
					
					<p:ajax event="select" listener="#{fileUploadBacking.onNodeSelect}" update="fileTree"/>
					
					<p:treeNode expandedIcon="ui-icon-folder-open" collapsedIcon="ui-icon-folder-collapsed">
						<h:outputText value="#{node}" />
					</p:treeNode>
					
					<p:treeNode type="document" icon="ui-icon ui-icon-document">
						<h:outputText value="#{node}"/>
					</p:treeNode>
				</p:tree>
			
    	</p:layoutUnit>
    	
    	<p:layoutUnit position="center" header="Select files form your computer to upload and save" >
    		  
	        	<p:fileUpload id="uploader"
                        	allowTypes="/(\.|\/)(hea|dat|xyz|xml)$/"
        	                value="Facts" 
        	                multiple="true"
      	                  	uploadLabel="Upload All"
            	            cancelLabel="Remove All" 
            	            auto="false"
                	        widgetVar="waveformFileUpload"
                    	    fileUploadListener="#{fileUploadBacking.handleFileUpload}"
                        	description="Select Images" 
                        	update="fileTree"/>
            
    	</p:layoutUnit>
    	  
	</p:layout>
	</h:form>
	
	</h:body>
</f:view>